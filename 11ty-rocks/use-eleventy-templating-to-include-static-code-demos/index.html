<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Use Eleventy Templating To Include Static Code Demos</title>
	<link rel="stylesheet" href="/11ty-test/css/style.css" />
</head>
<body>
	
		<nav class="background-primary">
			<a href="/">Steph&#39;s Favorite RSS</a>
			<small><em>Fetching results since Feb 25, 2021</em></small>
		</nav>
	

	<header >
			
		<div class="container container--item">
				<small><strong>Apr 2, 2021</strong></small>

				<h1>Use Eleventy Templating To Include Static Code Demos</h1>
				<p class="header-meta">

<span class="category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false" aria-hidden="true" width="24"><defs/><path d="M0 0h24v24H0V0z" fill="none"/><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg> <a href="/category/eleventy/">Eleventy</a></span>

 <a href="/11ty-rocks/">All from 11ty Rocks!</a> <strong><a href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/">View <span class="inclusively-hidden">Use Eleventy Templating To Include Static Code Demos</span> on 11ty.rocks</a></strong></p>
			
		</div>
	</header>
	<main>
	<article class="container item-article background-light">
<blockquote>
<p>This post assumes a foundational familiarity with Eleventy. If you're new to 11ty - welcome! You may want to <a href="https://11ty.rocks/posts/create-your-first-basic-11ty-website/">start here</a>.</p>
</blockquote>
<p>This tutorial will showcase many features of Nunjucks templating. So, even if the tutorial's goal doesn't match your use case, you'll get more familair with using it as a templating language!</p>
<h2 id="project-brief" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#project-brief">#</a>Project Brief</h2>
<p>The goal of this Eleventy project is to create a single-page site that displays live code demos, like the setup on <a href="https://smolcss.dev/">SmolCSS.dev</a>. And we'll see how to extend it to a scoped context like is used for <a href="https://moderncss.dev/developing-for-imperfect-future-proofing-css-styles/">this ModernCSS.dev tutorial</a>.</p>
<p>Here are the base requirements:</p>
<ul>
<li>ease of managing demo content</li>
<li>demo code lives with demo content</li>
<li>each demo is an independent file</li>
<li>allow custom ordering of demos vs. date-based</li>
<li>RSS feed for demos</li>
<li>&quot;Open in CodePen&quot; functionality</li>
</ul>
<h2 id="base-project-configuration" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#base-project-configuration">#</a>Base Project Configuration</h2>
<p>We're starting from an empty project with Eleventy installed and ready to run.</p>
<p>This tutorial will assume a customized <code>input</code> directory of <code>src</code>, and that you've created an <code>index</code> file where we'll eventually add the demo content.</p>
<p>If you're unsure how to do those things, follow my tutorial on <a href="https://11ty.rocks/posts/create-your-first-basic-11ty-website/">creating your first 11ty site</a> up until the <em>Create the Blog</em> step, and then come back to continue! ðŸ˜Š</p>
<p>You may also want to do the &quot;Create a CSS File&quot; and &quot;Link to Stylesheet&quot; sections in that tutorial if you are unfamiliar with how to do that with Eleventy.</p>
<blockquote>
<p>Setup your index as <code>index.njk</code> as we'll primary be using Nunjucks for this tutorial.</p>
</blockquote>
<h2 id="base-eleventy-setup-for-single-page-content" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#base-eleventy-setup-for-single-page-content">#</a>Base Eleventy Setup for Single-Page Content</h2>
<p>My favorite thing about Eleventy is the flexible content modeling. And most projects I do definitely benefit from the filesystem page creation, but for this project we'll need to disable that functionality.</p>
<p>So, our first step is to create a location for our code demos to live. Add <code>src/demos</code>, and then create the file <code>demos.json</code> with the following contents:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><br />  <span class="token string">"tags"</span><span class="token operator">:</span> <span class="token string">"demos"</span><span class="token punctuation">,</span><br />  <span class="token string">"permalink"</span><span class="token operator">:</span> <span class="token boolean">false</span><br /><span class="token punctuation">}</span></code></pre>
<p>This is a <em>data directory file</em> and we define <code>tags</code> to create the <code>demos</code> collection. Then we set <code>permalink</code> to <code>false</code> to prevent page generation. These values will apply to all content within the directory, although you could still set front matter to override them for specific content.</p>
<h2 id="create-a-demo-file" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#create-a-demo-file">#</a>Create a Demo File</h2>
<p>Let's create our first demo. Add <code>demo/centering.njk</code> with the following content:</p>
<pre class="language-md"><code class="language-md"><span class="token front-matter-block"><span class="token punctuation">---</span><br /><span class="token font-matter yaml language-yaml"><span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">"CSS Centering"</span><br /><span class="token key atrule">order</span><span class="token punctuation">:</span> <span class="token number">1</span><br /><span class="token key atrule">date</span><span class="token punctuation">:</span> <span class="token datetime number">2021-03-31</span><br /><span class="token key atrule">templateEngineOverride</span><span class="token punctuation">:</span> njk<span class="token punctuation">,</span> md</span><br /><span class="token punctuation">---</span></span></code></pre>
<p>We include an <code>order</code> property that we'll use to order our demos within our single page rather than relying on Eleventy's default of date-based ordering. This is because we may create multiples on the same day, and on publish they may change order from what we see locally.</p>
<p>There is also a date included for purposes of correctly updating the RSS feed we'll be adding.</p>
<p>Finally, we add <code>templateEngineOverride: njk, md</code> because we will be mixing Markdown with Nunjucks content in this file and we want both to be processed correctly.</p>
<h2 id="demo-partial-and-code-content" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#demo-partial-and-code-content">#</a>Demo Partial and Code Content</h2>
<p>You may be wondering why we didn't add any content in the previous step. Instead of directly outputting the content within the demo Nunjucks file, we're going to populate Nunjucks variables to pass into a partial. This will enable consistency among our code demos and allow enhanced functionality.</p>
<p>Create <code>src/_includes/demo.njk</code> which will be our partial.</p>
<p>Let's determine the parts we need to output for each demo:</p>
<ul>
<li>a title</li>
<li>a description</li>
<li>HTML</li>
<li>CSS</li>
</ul>
<p>Now, since this is a case study of <a href="https://smolcss.dev/">SmolCSS.dev</a>, we're going to focus on showing the CSS as highlighted code. You can extend the following ideas to also show the HTML, or perhaps only the HTML, or even add JavaScript into the mix.</p>
<p>Within <code>demo.njk</code> let's populate our demo template:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token punctuation">{</span> description <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><br /><span class="token operator">&lt;</span>style<span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token punctuation">{</span> css <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><br /><br /><span class="token operator">&lt;</span>details<span class="token operator">></span><br />  <span class="token operator">&lt;</span>summary<span class="token operator">></span><span class="token constant">CSS</span> <span class="token keyword">for</span> <span class="token string">"{{ title }}"</span><span class="token operator">&lt;</span><span class="token operator">/</span>summary<span class="token operator">></span><br /><br />  <span class="token punctuation">{</span><span class="token operator">%</span> highlight <span class="token string">"css"</span> <span class="token operator">%</span><span class="token punctuation">}</span><br />  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">-</span> css <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br />  <span class="token punctuation">{</span><span class="token operator">%</span> endhighlight <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>details<span class="token operator">></span><br /><br /><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"demo"</span><span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token punctuation">{</span> html <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></code></pre>
<p>Now this partial accepts the following variables:</p>
<ul>
<li><code>title</code> - used within the <code>summary</code> element since we're going to use the native HTML <code>details</code> element to enable collapsing the demo code</li>
<li><code>description</code> - included with the <code>safe</code> filter because the content will be pre-compiled from Markdown into HTML</li>
<li><code>css</code> - added twice so that it can be output as actual CSS within <code>style</code> tags, and also within a <code>highlight</code> block that will become the demo's sample code</li>
<li><code>html</code> - added within a <code>div.demo</code> so that we can style the demo container around the passed HTML content</li>
</ul>
<p>Let's go back to our first demo file and add the content within these variables:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> description <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token operator">**</span>Put down the <span class="token constant">CSS</span> centering jokes<span class="token operator">**</span><span class="token operator">!</span> This modern update is often the solution you're looking <span class="token keyword">for</span> to solve your centering woes<span class="token punctuation">.</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> endset <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> css <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token punctuation">.</span>centering <span class="token punctuation">{</span><br />  display<span class="token operator">:</span> grid<span class="token punctuation">;</span><br />  place<span class="token operator">-</span>content<span class="token operator">:</span> center<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><span class="token punctuation">{</span><span class="token operator">%</span> endset <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> html <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"centering"</span><span class="token operator">></span><br />  <span class="token operator">&lt;</span>span<span class="token operator">></span>Feeling Centered<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token operator">%</span> endset <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> include <span class="token string">"demo.njk"</span> <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>This sets the variables, and also includes the <code>demo</code> partial. For each demo file you create, continue this pattern of setting variables and including the partial.</p>
<p>Before we see some example output, this also assumes you are using <a href="https://www.11ty.dev/docs/plugins/syntaxhighlight/">eleventy-plugin-syntaxhighlight</a> and have pre-included a <a href="https://github.com/PrismJS/prism-themes">prism theme</a>.</p>
<p>Here's some starting CSS for the <code>details</code>, <code>summary</code>, and <code>.demo</code>:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">details</span> <span class="token punctuation">{</span><br />  <span class="token property">margin</span><span class="token punctuation">:</span> 2rem 0 0<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">details pre[class*="language-"]</span> <span class="token punctuation">{</span><br />  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">summary</span> <span class="token punctuation">{</span><br />  <span class="token property">padding</span><span class="token punctuation">:</span> 0.15em 0.5em<span class="token punctuation">;</span><br />  <span class="token property">background-color</span><span class="token punctuation">:</span> #0d3233<span class="token punctuation">;</span><br />  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span><br />  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">summary:focus</span> <span class="token punctuation">{</span><br />  <span class="token property">outline</span><span class="token punctuation">:</span> 2px solid #0d3233<span class="token punctuation">;</span><br />  <span class="token property">outline-offset</span><span class="token punctuation">:</span> 2px<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">.demo</span> <span class="token punctuation">{</span><br />  <span class="token property">min-height</span><span class="token punctuation">:</span> 30vh<span class="token punctuation">;</span><br />  <span class="token property">padding</span><span class="token punctuation">:</span> 1rem<span class="token punctuation">;</span><br />  <span class="token property">border</span><span class="token punctuation">:</span> 2px dashed currentColor<span class="token punctuation">;</span><br /><span class="token punctuation">}</span></code></pre>
<h3>Example Code Demo Output</h3>
<p><strong>Put down the CSS centering jokes</strong>! This modern update is often the solution you're looking for to solve your centering woes.</p>
<details>
  <summary>CSS for "Demo Output"</summary>
  <pre class="language-css"><code class="language-css"><span class="token selector">.centering</span> <span class="token punctuation">{</span><br />  <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span><br />  <span class="token property">place-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br />  <span class="token property">min-height</span><span class="token punctuation">:</span> 30vh<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">.centering span</span> <span class="token punctuation">{</span><br />  <span class="token property">padding</span><span class="token punctuation">:</span> .5em<span class="token punctuation">;</span><br />  <span class="token property">outline</span><span class="token punctuation">:</span> 2px solid<span class="token punctuation">;</span><br /><span class="token punctuation">}</span></code></pre>
</details>
<style>
.centering-33 {
  display: grid;
  place-content: center;
  min-height: 30vh;
}
<p>.centering-33 span {
padding: .5em;
outline: 2px solid;
}
</style></p>
<div class="demo">
<div class="centering-33">
  <span>Feeling Centered</span>
</div>
</div>
<h3>Extend the Code Partial</h3>
<p>The great thing about handling this via a partial that is passed variables to modify behavior is that you can build up <em>more</em> variables to alter the output when needed.</p>
<p>For example, maybe you don't <em>always</em> have HTML and description output and just want to show the CSS. So, you could create and handle for a <code>hideDemo</code> variable:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> not hideDescription <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token punctuation">{</span><span class="token punctuation">{</span> description <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">if</span> not hideDemo <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"demo"</span><span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token punctuation">{</span> html <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>Which would be set as follows within your code file:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> hideDescription <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> hideDemo <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>Resulting in only the details/summary appearing:</p>
<details>
  <summary>CSS for "Demo Output"</summary>
  <pre class="language-css"><code class="language-css"><span class="token selector">.centering</span> <span class="token punctuation">{</span><br />  <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span><br />  <span class="token property">place-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span><br />  <span class="token property">min-height</span><span class="token punctuation">:</span> 30vh<span class="token punctuation">;</span><br /><span class="token punctuation">}</span><br /><br /><span class="token selector">.centering span</span> <span class="token punctuation">{</span><br />  <span class="token property">padding</span><span class="token punctuation">:</span> .5em<span class="token punctuation">;</span><br />  <span class="token property">outline</span><span class="token punctuation">:</span> 2px solid<span class="token punctuation">;</span><br /><span class="token punctuation">}</span></code></pre>
</details>
<blockquote>
<p><strong>Challenge</strong>: Extend this to make the <code>open</code> property for <code>details</code> a variable so that you have the option to set the <code>details</code> to visible instead of collapsed</p>
</blockquote>
<h2 id="ordering-and-output-of-the-demos-collection" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#ordering-and-output-of-the-demos-collection">#</a>Ordering and Output of the <code>demos</code> Collection</h2>
<p>Now that we have our demo code files and partial figured out, it's time to figure out how to display this content. Remember - we turned off the default file system individual page creation.</p>
<p>We also had created a collection called <code>demos</code> when we defined the data directory file by assigning all of the files the tag of <code>demos</code>.</p>
<p>However, that collection will currently be date based as is the 11ty default. Since we want it based off the <code>order</code> front matter, we need to create a custom collection.</p>
<p>Add the following within <code>.eleventy.js</code> above the previous customization that updated the input/output directories:</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addCollection</span><span class="token punctuation">(</span><span class="token string">"orderedDemos"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">collection</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />  <span class="token keyword">return</span> collection<span class="token punctuation">.</span><span class="token function">getFilteredByTag</span><span class="token punctuation">(</span><span class="token string">"demos"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token keyword">return</span> a<span class="token punctuation">.</span>data<span class="token punctuation">.</span>order <span class="token operator">-</span> b<span class="token punctuation">.</span>data<span class="token punctuation">.</span>order<span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>This takes the <code>demos</code> collection and reorders it by our custom <code>order</code> key and returns a new collection called <code>orderedDemos</code>.</p>
<p>Now we can loop through the new collection to output it within our main index:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> demo <span class="token keyword">in</span> collections<span class="token punctuation">.</span>orderedDemos <span class="token operator">%</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span>article<span class="token operator">></span><br />  <span class="token operator">&lt;</span>h2 id<span class="token operator">=</span><span class="token string">"{{ demo.fileSlug }}"</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> demo<span class="token punctuation">.</span>data<span class="token punctuation">.</span>title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">></span><br />  <span class="token punctuation">{</span><span class="token punctuation">{</span> demo<span class="token punctuation">.</span>templateContent <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><br /><span class="token operator">&lt;</span><span class="token operator">/</span>article<span class="token operator">></span><br /><span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>This is a minimal example where we are adding fully compiled demo <code>templateContent</code> within an <code>article</code>. We also pass in the main demo front matter <code>title</code> within an <code>h2</code> that includes an <code>id</code> set to the demo's file slug in case you'd like to enable anchor links to each demo.</p>
<h2 id="rss-feed" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#rss-feed">#</a>RSS Feed</h2>
<p>To setup an RSS feed, install the <code>eleventy-plugin-rss</code> plugin and follow the instructions and use the example code from <a href="https://www.11ty.dev/docs/plugins/rss/">the RSS plugin docs</a>.</p>
<p>The only alteration is to change from the <code>posts</code> collection to use our <code>orderedDemos</code> collection to correctly order the feed. In addition, you'll need to pass the <code>reverse</code> filter, resulting in the following start of the feed loop:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token operator">-</span> <span class="token keyword">for</span> item <span class="token keyword">in</span> collections<span class="token punctuation">.</span>orderedDemos <span class="token operator">|</span> reverse <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<h2 id="open-in-codepen" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#open-in-codepen">#</a>&quot;Open in CodePen&quot;</h2>
<p>A bit of functionality that provides a valuable extra resource for our readers is the ability to export the demo code to CodePen.</p>
<p>I've abstracted my solution as used on SmolCSS.dev and ModernCSS.dev into the plugin <a href="https://www.npmjs.com/package/@11tyrocks/eleventy-plugin-open-in-codepen"><code>@11tyrocks/eleventy-plugin-open-in-codepen</code></a>.</p>
<p>Here's an example of configuring the plugin:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> openInCodepen <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@11tyrocks/eleventy-plugin-open-in-codepen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">eleventyConfig</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />  eleventyConfig<span class="token punctuation">.</span><span class="token function">addPlugin</span><span class="token punctuation">(</span>openInCodepen<span class="token punctuation">,</span> <span class="token punctuation">{</span><br />    siteUrl<span class="token operator">:</span> <span class="token string">"YourSite.dev"</span><span class="token punctuation">,</span><br />    siteTitle<span class="token operator">:</span> <span class="token string">"Your Site"</span><span class="token punctuation">,</span><br />    siteTag<span class="token operator">:</span> <span class="token string">"yoursite"</span><span class="token punctuation">,</span><br />    buttonClass<span class="token operator">:</span> <span class="token string">"your-button-class"</span><span class="token punctuation">,</span><br />    buttonIconClass<span class="token operator">:</span> <span class="token string">"your-button-icon-class"</span><span class="token punctuation">,</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Which would then make the shortcode <code>postToCodepen</code> available within your partial. You can include the button with the following updates:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Set in your code demo file</span><br /><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> slug <span class="token operator">=</span> page<span class="token punctuation">.</span>url <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token comment">// Add where you'd like it to appear in the partial</span><br /><span class="token punctuation">{</span><span class="token operator">%</span> postToCodepen title<span class="token punctuation">,</span> slug<span class="token punctuation">,</span> css<span class="token punctuation">,</span> html <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>Here is a working example of the button created by the shortcode (and including customizations specific to 11ty Rocks!) that will export the demo that we set up in this tutorial:</p>
<form action="https://codepen.io/pen/define" method="POST" target="_blank">
        <input type="hidden" name="data" value="{&quot;title&quot;:&quot;11ty Rocks! - Demo Output&quot;,&quot;description&quot;:&quot;Generated from: 11ty.Rocks/posts/eleventy-templating-static-code-demos/&quot;,&quot;tags&quot;:[&quot;11tyrocks&quot;],&quot;editors&quot;:&quot;110&quot;,&quot;layout&quot;:&quot;left&quot;,&quot;html&quot;:&quot;<!-- 11ty Rocks! - Demo Output\nGenerated from: 11ty.Rocks/posts/eleventy-templating-static-code-demos/ -->\n\n<div class=\&quot;centering\&quot;>\n  <span>Feeling Centered</span>\n</div>\n&quot;,&quot;html_pre_processor&quot;:&quot;none&quot;,&quot;css&quot;:&quot;/* Box sizing rules */\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n\n/* Remove default margin */\nbody,\nh1,\nh2,\nh3,\nh4,\np {\n  margin: 0;\n}\n\n/* Set core body defaults */\nbody {\n  min-height: 100vh;\n  text-rendering: optimizeSpeed;\n  line-height: 1.5;\n  font-family: system-ui, sans-serif;\n}\n\n/* Make images easier to work with */\nimg {\n  display: block;\n  max-width: 100%;\n}\n\n/***\n ðŸŸ£ 11ty Rocks! Demo Styles\n */\n\n.centering {\n  display: grid;\n  place-content: center;\n  min-height: 30vh;\n}\n\n.centering span {\n  padding: .5em;\n  outline: 2px solid;\n}\n&quot;,&quot;css_pre_processor&quot;:&quot;scss&quot;,&quot;css_starter&quot;:&quot;neither&quot;,&quot;css_prefix&quot;:&quot;autoprefixer&quot;,&quot;head&quot;:&quot;<meta name=&apos;viewport&apos; content=&apos;width=device-width, initial-scale=1&apos;>&quot;}" />
        <button class="tdbc-button tdbc-button--secondary" type="submit" data-name="Demo Output" aria-label="Open Demo Output in CodePen"><span class="tdbc-button__icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" aria-hidden="true" focusable="false">
      <path d="M32 10.909l-0.024-0.116-0.023-0.067c-0.013-0.032-0.024-0.067-0.040-0.1-0.004-0.024-0.020-0.045-0.027-0.067l-0.047-0.089-0.040-0.067-0.059-0.080-0.061-0.060-0.080-0.060-0.061-0.040-0.080-0.059-0.059-0.053-0.020-0.027-14.607-9.772c-0.463-0.309-1.061-0.309-1.523 0l-14.805 9.883-0.051 0.053-0.067 0.075-0.049 0.060-0.067 0.080c-0.027 0.023-0.040 0.040-0.040 0.061l-0.067 0.080-0.027 0.080c-0.027 0.013-0.027 0.053-0.040 0.093l-0.013 0.067c-0.025 0.041-0.025 0.081-0.025 0.121v9.996c0 0.059 0.004 0.12 0.013 0.18l0.013 0.061c0.007 0.040 0.013 0.080 0.027 0.115l0.020 0.067c0.013 0.036 0.021 0.071 0.036 0.1l0.029 0.067c0 0.013 0.020 0.053 0.040 0.080l0.040 0.053c0.020 0.013 0.040 0.053 0.060 0.080l0.040 0.053 0.053 0.053c0.013 0.017 0.013 0.040 0.040 0.040l0.080 0.056 0.053 0.040 0.013 0.019 14.627 9.773c0.219 0.16 0.5 0.217 0.76 0.217s0.52-0.080 0.76-0.24l14.877-9.875 0.069-0.077 0.044-0.060 0.053-0.080 0.040-0.067 0.040-0.093 0.021-0.069 0.040-0.103 0.020-0.060 0.040-0.107v-10c0-0.067 0-0.127-0.021-0.187l-0.019-0.060 0.059 0.004zM16.013 19.283l-4.867-3.253 4.867-3.256 4.867 3.253-4.867 3.253zM14.635 10.384l-5.964 3.987-4.817-3.221 10.781-7.187v6.424zM6.195 16.028l-3.443 2.307v-4.601l3.443 2.301zM8.671 17.695l5.964 3.987v6.427l-10.781-7.188 4.824-3.223v-0.005zM17.387 21.681l5.965-3.973 4.817 3.227-10.783 7.187v-6.427zM25.827 16.041l3.444-2.293v4.608l-3.444-2.307zM23.353 14.388l-5.964-3.988v-6.44l10.78 7.187-4.816 3.224z"></path>
    </svg></span> Open in CodePen</button>
        </form>
<h2 id="prevent-global-affects-on-demo-css" tabindex="-1"><a class="tdbc-anchor" href="https://11ty.rocks/posts/eleventy-templating-static-code-demos/#prevent-global-affects-on-demo-css">#</a>Prevent Global Affects on Demo CSS</h2>
<p>If your use case is to populate demos within a context where you don't want your site's global CSS to cascade and affect your demo CSS, we can add a shortcode to help scope the styles.</p>
<p>But first, here's a starting set of styles for our <code>.demo</code> contents to reset most cascaded properties. You may find you need to add more properties here depending on what elements you are using in the demo. The goal is to prevent most global styles leaking through (and demo styles leaking out!) so that the demo styles are closer to being fresh from a native browser style base. If you are using a style reset, those rules may still come through for certain elements which is likely desireable.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.demo *</span> <span class="token punctuation">{</span><br />  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span><br />  <span class="token property">padding</span><span class="token punctuation">:</span> unset<span class="token punctuation">;</span><br />  <span class="token property">border</span><span class="token punctuation">:</span> unset<span class="token punctuation">;</span><br />  <span class="token property">border-radius</span><span class="token punctuation">:</span> unset<span class="token punctuation">;</span><br />  <span class="token property">color</span><span class="token punctuation">:</span> unset<span class="token punctuation">;</span><br />  <span class="token property">font</span><span class="token punctuation">:</span> unset<span class="token punctuation">;</span><br />  <span class="token property">font-family</span><span class="token punctuation">:</span> system-ui<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span><br /><span class="token punctuation">}</span></code></pre>
<p>Next, we'll create the shortcode. A shortcode can output content, and we'll actually use it to output both the <code>&lt;style&gt;</code> and <code>.demo</code> blocks, replacing what we previously had for the HTML in the partial.</p>
<p>Here is the content of the <code>codeDemo</code> shortcode, which intakes the <code>css</code> and <code>html</code> (if available). Then it finds the CSS class names, and replaces them with a version that has a &quot;hash&quot; (just a simple random number string for this context). Following that, it traverses the HTML and updates the matched CSS class names so that the hashed CSS selector matches the demo HTML.</p>
<pre class="language-js"><code class="language-js">eleventyConfig<span class="token punctuation">.</span><span class="token function">addShortcode</span><span class="token punctuation">(</span><span class="token string">"codeDemo"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">css<span class="token punctuation">,</span> html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br />  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>html<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><br /><br />  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>css<span class="token punctuation">)</span> <span class="token punctuation">{</span><br />    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br />&lt;div class="demo"><br /></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>html<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br />&lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><br /><br />  <span class="token keyword">const</span> hash <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token keyword">const</span> cssRE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(?&lt;=\.)([\w|-]+)(?=\s|,)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">"gm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token keyword">const</span> cssCode <span class="token operator">=</span> css<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>cssRE<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">$1-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hash<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token keyword">let</span> htmlCode <span class="token operator">=</span> html<span class="token punctuation">;</span><br />  css<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>cssRE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">match</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token comment">// prettier-ignore</span><br />    <span class="token keyword">const</span> htmlPattern <span class="token operator">=</span> match<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">"\\-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">const</span> htmlRE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>htmlPattern<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)(?=\\s|")</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token string">"gm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    htmlCode <span class="token operator">=</span> htmlCode<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>htmlRE<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>match<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hash<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string"><br />&lt;style></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cssCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/style><br />&lt;div class="demo"><br /></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>htmlCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"><br />&lt;/div></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>A couple notes:</p>
<ul>
<li>the indentation isn't an accident but necessary since we have setup our demo to process <em>both</em> Markdown and Nunjucks, and if those blocks are indented it fouls up that processing</li>
<li>this scoping method requires you to use class selectors, which means if you are using element selectors you will have to prefix them with a class which must exist in the passed HTML</li>
</ul>
<p>Then in the partial, remove our previous block that output the HTML <code>.demo</code> and replace it with the following:</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">set</span> htmlCode <span class="token operator">%</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token string">''</span> <span class="token keyword">if</span> hideDemo <span class="token keyword">else</span> html <span class="token operator">|</span> safe <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span> endset <span class="token operator">%</span><span class="token punctuation">}</span><br /><br /><span class="token punctuation">{</span><span class="token operator">%</span> codeDemo css<span class="token punctuation">,</span> htmlCode <span class="token operator">%</span><span class="token punctuation">}</span></code></pre>
<p>This still takes into account the <em>option</em> to hide the demo.</p>
<p><strong>Important note about Nunjucks variables</strong>: They will pass through multiple instances of a partial if you include the partial multiple times within one file. If you are writing a tutorial and set the <code>html</code> variable at the top of the file, you can repeatedly update the <code>css</code> variable only prior to including the partial again and it will use the original HTML up until you update the <code>html</code> variable. This is super useful for tutorials showing how to progressively build something. In fact, this technique was created for exactly that purpose over on this <a href="https://moderncss.dev/developing-for-imperfect-future-proofing-css-styles/">tutorial for ModernCSS.dev</a>.</p>
<blockquote>
<p>Phew! That was a lot to learn about Nunjucks templating ðŸ˜Š I'd love to know if this was helpful to you and see what you make with it! Reach out to <a href="https://twitter.com/5t3ph">@5t3ph on Twitter</a></p>
</blockquote>
</article>
	</main>
	<footer class="background-primary">
		<p><a href="https://github.com/5t3ph/eleventy-rss-reader">eleventy-rss-reader</a> created by <a href="https://twitter.com/5t3ph">Stephanie Eckles</a></p>
	</footer>

	
	<script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
	
</body>
</html>