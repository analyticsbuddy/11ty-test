<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>How I set up Glyphhanger on macOS for optimizing and converting font files for the Web</title>
	<link rel="stylesheet" href="/11ty-test/css/style.css" />
</head>
<body>
	
		<nav class="background-primary">
			<a href="/">Steph&#39;s Favorite RSS</a>
			<small><em>Fetching results since Feb 25, 2021</em></small>
		</nav>
	

	<header >
			
		<div class="container container--item">
				<small><strong>Mar 2, 2021</strong></small>

				<h1>How I set up Glyphhanger on macOS for optimizing and converting font files for the Web</h1>
				<p class="header-meta">

<span class="category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" focusable="false" aria-hidden="true" width="24"><defs/><path d="M0 0h24v24H0V0z" fill="none"/><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg> <a href="/category/css/">CSS</a></span>

 <a href="/blog-on-sarasoueidancom/">All from Blog on SaraSoueidan.com</a> <strong><a href="https://sarasoueidan.com/blog/glyphhanger/">View <span class="inclusively-hidden">How I set up Glyphhanger on macOS for optimizing and converting font files for the Web</span> on sarasoueidan.com</a></strong></p>
			
		</div>
	</header>
	<main>
	<article class="container item-article background-light">
<p class="size-2x">
I can't count the number of times I've tried installing a command line tool on my machine, only to find myself going down a black hole of node modules & dependencies, and a seemingly non-ending list of error messages in the terminal. This would go on for a while before I finally give up and call it quits, only to revert back to find myself googling the name of an online app and using that to do what I need instead.
</p>
<p>Yesterday, the same thing <em>almost</em> happened again. I got into another black hole in iTerm as I tried to install a couple of Web font conversion and optimization tools. I almost gave up before I finally managed to <em>kind of</em> get everything working the way I wanted it to. A lot of googling and &ldquo;stack-overflowing&rdquo; was involved in this process. I&rsquo;m sharing my struggles in this post in the hopes that it might help someone out should they get stuck where I did. I also want to have a reference to come back in the future should I ever find myself installing the same tools again.</p>
<hr>
<p>Yesterday was just another typical work day. I was setting up the foundation for a new client project. The Web site we&rsquo;re building uses the Inter font family for the typography. So, I head over to <a href="https://fonts.google.com">Google Fonts</a>, found <a href="https://fonts.google.com/specimen/Inter?preview.text_type=custom">the Inter family page</a>, and clicked that <strong>“Download family”</strong> button.</p>
<p>As you probably already know, Google Fonts doesn&rsquo;t supply the fonts in WOFF or WOFF2 formats. When you download a font, you only get TTF font files. Why that is, I don&rsquo;t know. Jeremy <a href="https://adactio.com/journal/17480">has wondered the same</a> before. And if you&rsquo;re a front-end developer you should also know that TTF is not the best choice for serving Web fonts, and that WOFF and WOFF2 are far leaner and more performant.</p>
<p>So, as usual, I set out to convert the TTF files to WOFF and WOFF2 to serve them up in my project.</p>
<h2 id="my-previous-font-conversion-workflow">My previous font conversion workflow</h2>
<p>Normally, I&rsquo;d head over to one of the online tools available — whatever comes up first in Google search, because I&rsquo;ve never bookmarked one tool to use at all times, even though I tend to use <a href="https://www.fontsquirrel.com/tools/webfont-generator">Font Squirrel generator</a> quite often. But that has always felt like too much of a hassle. Ideally, I&rsquo;d be able make this conversion  <em>within the folder in which they are located</em>.</p>
<p>So the workflow would look like this:</p>
<ol>
<li>download font,</li>
<li>unzip &amp; open folder,</li>
<li>convert to WOFF &amp; WOFF2,</li>
<li>copy to project folder and embed on page.</li>
</ol>
<p>&hellip;<strong>instead of:</strong> download font, unzip &amp; open folder, find an online tool, upload font files, wait for conversion, download fonts, unzip &amp; open folder, and then move to project folder and embed on the page. This has always felt like an clunky workflow. It always bothered me that I had to click and switch contexts as much as I did.</p>
<hr>
<p>So, yesterday <a href="https://twitter.com/SaraSoueidan/status/1366275965215793153?s=20">I saught the help of the amazing Twitter #lazyWeb</a> and asked my friends there what they use to convert their font files on macOS. Many responded with links to online tools, which is what I&rsquo;m wanting to avoid. And some responded with recommendations for a few command line tools.</p>
<p>I imagined I&rsquo;d want a nice drag and drop tool for this. But command line tools are also pretty handy, and usually very flexible, too. Once you&rsquo;ve got one set up, it could help streamline your font conversion process. And since I&rsquo;m much more comfortable in the command line today than I was a few years ago, I thought it was about time I switched to one of those tools.</p>
<p>I was instantly sold on <a href="https://www.filamentgroup.com/">Filament Group</a>’s <a href="https://github.com/filamentgroup/glyphhanger"><code>glyphhanger</code></a>. “<code>glyphhanger</code> is a useful tool when working with web fonts—it can help optimize your font files very quickly”.</p>
<p>Not only does <code>glyphhanger</code> convert font files, but it also subsets them <small>(i.e. it removes unnecessary characters from a font file)</small>, which is another optimization step you want to make to serve more performant fonts. (That, and the fact that I love the work of the folks at Filament Group, who have always been big proponents of performance.)</p>
<p>The <a href="https://github.com/filamentgroup/glyphhanger">Github repository</a>&rsquo;s README file includes installation instructions. And that&rsquo;s where I started yesterday&hellip;</p>
<h2 id="installing-glyphhanger">Installing Glyphhanger</h2>
<p>I&rsquo;m going to start with the process I went through and the issues and errors I got. If you&rsquo;re not interested in that, you can skip straight to <a href="#setup">the solution</a>.</p>
<h3 id="down-the-rabbit-hole">Down the rabbit hole</h3>
<p><code>glyphhanger</code> is available on npm. According to the reposiroty&rsquo;s README, installation is as simple as running:</p>
<pre class="language-css">
npm install -g glyphhanger
</pre>
<p>I ran that command. <code>glyphhanger</code> was installed. Yay. So far so good.</p>
<p>Following that line in the README is a note that says that <code>pyftsubset</code> is a prerequisite. I wasn&rsquo;t familiar with what <code>pyftsubset</code> is, so I kept on reading. <small>(Honestly, does everyone know what everything is?)</small></p>
<p>There was a link to another Github repository: <a href="https://github.com/fonttools/fonttools">fontTools</a>. I chose <code>glyphhanger</code> for its subsetting feature, and the subsetting functionality requires you to install <a href="https://github.com/fonttools/fonttools">fonttools</a>. So, I had a dependency to install. Reading the README of the fontTools repo only complicated things for me. So, I kept on reading the <code>glyphhanger</code> instructions.</p>
<p><small>(At this point: I couldn&rsquo;t make the direct connection between <code>pyftsubset</code> and fontTools at first. Later on, I googled “pyftsubset fonttools” and learned that <code>pyftsubset</code> is an OpenType font subsetter and optimizer, based on fontTools. And that&rsquo;s why you need to install fontTools.)</small></p>
<p>The next instruction is:</p>
<pre class="language-css">
pip install fonttools
</pre>
<p>I had no idea what <code>pip</code> is. I decided to run the command before googling anything. Unsurprisingly, that&rsquo;s when I got my first error.</p>
<pre class="language-css">
zsh: command not found: pip
</pre>
<p>Oups. OK so apparently I need to have Pip installed on my machine. Not knowing what it is, I started googling. I learned that Pip is a package manager for Python. And that to install Pip, I needed to have Python installed.</p>
<p>Many articles mentioned that macOS already comes with a version of Python installed. So I looked for what I needed to install Pip using the Python that&rsquo;s already installed. For some reason, none of the commands I found worked. So I thought: &ldquo;maybe Python <em>isn&rsquo;t</em> installed on my machine?&rdquo;. So I opened a new browser tab and started googling for how to install Python.</p>
<p>¯_(ツ)_/¯</p>
<p>While I was at it, I was following the rest of the instructions in the README. I didn&rsquo;t know what depended on what, so I thought I&rsquo;d try continuing async.</p>
<p>The following instructions are about cloning the Brotli and Zopfli git repositories and installing them because they are required to get WOFF and WOFF2 support:</p>
<pre class="language-css">
# Additional installation for --flavor=woff2
git clone https://github.com/google/brotli
cd brotli
python setup.py install
<h1>Additional installation for --flavor=woff --with-zopfli</h1>
<p>git clone https://github.com/anthrotype/py-zopfli
cd py-zopfli
git submodule update --init --recursive
python setup.py install
</pre></p>
<p>As you might have noticed already, these steps require Python to work, and since I didn&rsquo;t have Python working for me at this point yet, I got quite a bunch of errors in the terminal. Trying to install Brotli and Zopfli like that confirmed to me that Python maybe is, indeed, <em>not</em> installed by default.</p>
<p>fontTools is also a Python project, which, naturally, requires Python to work. (Duh.)</p>
<p>So it was very obvious at this point that what I needed to focus on was getting Python and Pip set up if I wanted any of this to work.</p>
<p>After googling quite a bit and jumping between articles and Stack Overflow Q&amp;As, I learned that there are multiple versions of Python (obviously), the latest (I think) is Python 3. Now this is where the weirdness started. After installing Python 3, if I wanted to run a Python command, I needed to use <code>python3</code> followed by the command. Not <code>python</code>. According to <a href="https://www.addictivetips.com/mac-os/install-python-3-on-macos/">a nice article I found later</a>, “in order to send commands to Python 3, you will need to enter <code>python3</code> in the terminal. If you enter <code>python</code>, the command will be sent to Python 2.”</p>
<p>So anyway, I installed Python using <code>brew</code>:</p>
<pre class="language-css">
brew install python3
</pre>
<p>Yep. That worked. I don&rsquo;t remember if I had any issues here. But then again, I had so many issues that I don&rsquo;t remember when and where I got each.</p>
<p>¯_(ツ)_/¯</p>
<p><small><strong>Here&rsquo;s a quick tip:</strong> If you, like me, want to avoid <code>brew</code> updating every time you use the <code>brew</code> command, you can use <code>HOMEBREW_NO_AUTO_UPDATE=1</code>.
I have a snippet setup so that every time I type <code>brew</code> and press TAB, it autocompletes to <code>HOMEBREW_NO_AUTO_UPDATE=1 brew</code>, so that I can run whatever brew command I want without allowing it to update. I learned this a few months ago when I got sick of brew updating every time I wanted to run a quick command. I googled, and found this tip on Stack Overflow and have been using it since.</small></p>
<p>Next, I needed to install Pip. Once again, I found several articles, each mentioning a different way to do it. To be quite honest, I don&rsquo;t remember which one of those I ended up following. I did learn though that with Python 3 comes Pip 3.</p>
<p>I installed Pip 3.</p>
<p>At this point, I realized I should have everything I needed to continue going through the README instructions. So, again, I tried installing <code>fonttools</code> using <code>pip install fonttools</code>. After getting yet more errors, I learned that, just like <code>python3</code> I need to use <code>pip3</code> instead of <code>pip</code>.</p>
<pre class="language-css">
pip3 install fonttools
</pre>
<p>That worked. So I got Python, Pip, and fontTools out of the way.</p>
<p>To generate optimized WOFF and WOFF2 font files, I needed Brotli and Zopfli. I have no idea why I still got some errors by following the installation instructions in the README (cloning the git repos for each). So, more googling ensued. Turns out, installing Brotli and Zopfli was much easier now that I had Pip installed. I didn&rsquo;t even need to clone the git repositories like the README instructed. All I needed is these two commands:</p>
<pre class="language-css">
pip3 install brotli
pip3 install zopfli
</pre>
<p>And <em>Boom!</em> all dependencies were installed. <em>Now</em> when I used <code>glyphhanger</code> to convert my font files, it finally generated the optimized TTF, WOFF, and WOFF2 files.</p>
<p>So, to sum up:</p>
<h3 id="setup"> tl;dr: installing all dependencies and running glyphhanger</h3>
<ol>
<li>
<p>Install <code>glyphhanger</code>: <pre class="language-css">
npm install -g glyphhanger
</pre></p>
</li>
<li>
<p>Install Python 3: <pre class="language-css">
brew install python3
</pre></p>
</li>
<li>
<p>Install pip. Python 3 comes with pip 3. Follow the instructions in <a href="https://www.addictivetips.com/mac-os/install-python-3-on-macos/">this article</a> to install pip.</p>
</li>
<li>
<p>Install fontTools using pip: <pre class="language-css">
pip3 install fonttools
</pre></p>
</li>
<li>
<p>Install Brotli and Zopfli using pip: <pre class="language-css">
pip3 install brotli
pip3 install zopfli
</pre></p>
</li>
<li>
<p>And then use <code>glyphhanger</code> to subset and create optimized formats of your TTF font files: <pre class="language-css">
glyphhanger &ndash;subset=*.ttf
</pre></p>
</li>
</ol>
<p>Zach Leatherman has <a href="https://www.zachleat.com/web/glyphhanger/">a post</a> that introduces <code>glyphhanger</code> with examples of how to use it. You&rsquo;ll want to read his article and the repository&rsquo;s README for further customizations and usage options because there are quite a few.</p>
<h2 id="optimizing-variable-fonts">Optimizing Variable Fonts</h2>
<p><code>glyphhanger</code> also generates WOFF2 files for Variable fonts. The file size of the subsetted Variable Inter WOFF2 file generated by <code>glyphhanger</code> is slightly smaller than the file size generated by Google&rsquo;s <a href="https://github.com/google/woff2">woff2 library</a> (302KB compared to 308KB). It does not break the Variable axes of the font like other online tools might, so it is safe to use it in your projects.</p>
<p><strong>Useful resources:</strong></p>
<ul>
<li><a href="https://clearleft.com/posts/how-to-use-variable-fonts-in-the-real-world">How to use variable fonts in the real world</a></li>
<li><a href="https://henry.codes/writing/how-to-convert-variable-ttf-font-files-to-woff2/">How To Convert Variable TTF Font Files to WOFF2</a> — this post explains how to set up the woff2 library and use it to generate WOFF2 from a Variable TTF font file. I&rsquo;ve found it to be more helpful than the library&rsquo;s README file. Make sure to follow the steps and commands to the letter.</li>
</ul>
<hr>
<p>While I finally managed to get <code>glyphhanger</code> set up and can now use it generate optimized Web font files, it still bugs me that I am <em>still</em> getting an error when using it. My terminal looks like this every time I run the command:</p>
<img src="../../images/glyphhanger-error.png" alt="Screenshot of the errors shown in the terminal after running the glyphhanger command to subset and generate font files.">
<p>I googled a lot trying to find what that error means and where it&rsquo;s coming from. I would love to get a clean output every time I run <code>glyphhanger</code>. I mean, it&rsquo;s such a great tool. I want the output to be just as great. But after spending <em>quite</em> some time on getting it to work, I wasn&rsquo;t left with enough patience to figure the solution out. If you have an idea what might be causing it, please do <a href="https://twitter.com/SaraSoueidan">let me know</a> — I&rsquo;d appreciate it a lot.</p>
<p>✨ <strong>UPDATE:</strong> ✨ Twitter came to the rescue once again. <a href="https://twitter.com/LurkGently">@GentlyLurk</a> figured out that the issue is coming from the version of <code>shelljs</code> used in <code>glyphhanger</code>, and kindly <a href="https://twitter.com/GentlyLurk/status/1366695429212172288?s=20">shared the fix</a>:</p>
<ol>
<li>Run <code>which glyphhanger</code> in the command line. This should give you the path to the folder inside which <code>glyphhanger</code> resides. (My result was <code>/usr/local/bin/glyphhanger</code>; it&rsquo;s a hidden folder so I had to <code>cmd+shift+.</code> to view it.)</li>
<li>Find the <code>package.json</code> file in the folder and change the version of <code>shelljs</code> to <code>0.8.4</code>, then</li>
<li>run <code>npm install</code> (inside the folder)</li>
</ol>
<p>Now the errors are finally gone. 🥳 If I run <code>glyphhanger --subset=Inter-Light.ttf</code> for example, the result I get in the command line looks like this:</p>
<img src="../../images/glyphhanger-no-errors.png" alt="Screenshot of the terminal after running the glyphhanger command showing only the result of generating 3 optimized font files, with no errors whatsoever.">
<p>(Look at those WOFF2 savings!)</p>
<p>🎉🎉🎉</p>
<p>✨ <strong>UPDATE #2 (March 11, 2021):</strong> ✨ <a href="https://twitter.com/zachleat/status/1370028833882132481">Zach announced</a> the release of glyphhanger v4, which includes dependency updates that fix the console warning issue that I had and that required the manually changing the <code>shelljs</code> version in the package.json file. So if you follow the installation steps above, you should have a clean console output without the extra hassle. 🎉</p>
<h2 id="more-articles-on-font-subsetting">More articles on font subsetting</h2>
<ul>
<li><a href="https://fuzzylogic.me/posts/how-i-subset-web-fonts/">How I subset web fonts</a></li>
<li><a href="https://www.zachleat.com/web/css-tricks-web-fonts/">Developing a robust font loading strategy for CSS-Tricks</a></li>
</ul>
</article>
	</main>
	<footer class="background-primary">
		<p><a href="https://github.com/5t3ph/eleventy-rss-reader">eleventy-rss-reader</a> created by <a href="https://twitter.com/5t3ph">Stephanie Eckles</a></p>
	</footer>

	
	<script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
	
</body>
</html>